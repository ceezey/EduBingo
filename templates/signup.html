<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Management System - Sign up page</title>
    <!-- google font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <!-- main css -->
    <link rel="stylesheet" href="../static/css/main.css" />
    <link rel="stylesheet" href="../static/css/entry-page.css" />
  </head>
  <body>
    <div class="row height-full">
      <!-- left side -->
      <div
        class="left-column flex flex-column height-full justify-center items-center"
      >
        <h1 class="welcoming-title">Create Your Account and Join Us!</h1>
        <form method="post" id="Account" class="form" autocomplete="off">
          <p class="signup-reminder">
            Sign up now to keep your tasks 
            organized and effortlessly manage everything in one place!
          </p>
          <label for="email" class="label">Email</label>
          <input type="email" name="email" id="email" class="input" required />

          <label for="password" class="label">Password</label>
          <input
            type="password"
            name="password"
            id="password"
            class="input"
            required
          />

          <button
            type="submit"
            class="button regular-button pink-background cta-btn"
          >
            Sign up
          </button>
        </form>
        <p class="login-prompt">
          Already have an account?
          <a href="/login.html" class="log-in-link">Log in</a>
        </p>
      </div>
      <!-- right side -->
      <div class="right-column"></div>
    </div>
    <script>
      // Select the form and listen for submit event
      document.getElementById('Account').addEventListener('submit', async function (e) {
          e.preventDefault(); // Prevent the form from refreshing the page

          // Get form values
          const email = document.getElementById('email').value;
          const password = document.getElementById('password').value;

          // Prepare data for POST request
          const data = new URLSearchParams();
          data.append('email', email);
          data.append('password', password);

          try {
              // Make the POST request using Fetch API
              const response = await fetch('/signup', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/x-www-form-urlencoded', // Use this for form data
                  },
                  body: data.toString() // Send URL-encoded form data
              });

              if (response.ok) {
                  const result = await response.text(); // Get the server's response
                  document.getElementById('responseMessage').innerText = 'Signup successful!';
              } else {
                  const error = await response.text();
                  document.getElementById('responseMessage').innerText = `Error: ${error}`;
              }
          } catch (error) {
              console.error('Error:', error);
              document.getElementById('responseMessage').innerText = 'An error occurred.';
          }
      });
  </script>
  </body>
</html>